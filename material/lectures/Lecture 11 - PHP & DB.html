<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Web Programming: PHP and DB </title>

		<link rel="shortcut icon" type="image/x-icon" href="./images/favicon.ico" />
		<meta name="description" content="Web Programming creating beautiful interactive and engaging web pages - using client server side technologies - PHP and DB ">
		<meta name="author" content="Ben Kenwright">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="./css/reset.css">
		<link rel="stylesheet" href="./css/reveal.css">
		<link rel="stylesheet" href="./css/theme/white.css" id="theme">
		

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="./lib/css/monokai.css">
		
		<link rel="stylesheet" href="./css/reveal-override.css"/>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? './css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h2>PHP and DB</h2>
					<h4>F28WP Web Programming</h4>
					<p>
						<small>2020-2021</small>
					</p>
				</section>


				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Overview

						* **How** to use **PHP** with a **Database**?
						* Embedded SQL Database (**SQLite**)
						* Examples
						* Questions and Discussion
						
					</textarea>
				</section>
				
				<section>
					<section data-markdown data-transition="slide" data-background="#20533c" data-background-transition="zoom">
						<textarea data-template>
						## Revision Question
						How do you write "Hello world" in PHP?
						
						
						* A.  ```echo "Hello world";```
						* B.  ```"Hello world";```
						* C.  ```Document.Write("Hello world");```
				

						</textarea>
					</section>
					
					<section data-markdown data-transition="slide" data-background="#20533c" data-background-transition="zoom">
						<textarea data-template>
						## Answer
						
						Answer: **A.** ```echo "Hello world";```

						</textarea>
					</section>
				</section>
				
				<section>
					<section data-markdown data-transition="slide" data-background="#90533c" data-background-transition="zoom">
						<textarea data-template>
						## Revision Question
						All variables in PHP start with which symbol?
						
						
						* A. ```$```
						* B. ```!```
						* C. ```&```
				

						</textarea>
					</section>
					
					<section data-markdown data-transition="slide" data-background="#90533c" data-background-transition="zoom">
						<textarea data-template>
						## Answer
						
						Answer: **A.** ```$```

						</textarea>
					</section>
				</section>
				
				<section>
					<section data-markdown data-transition="slide" data-background="#20533c" data-background-transition="zoom">
						<textarea data-template>
						## Revision Question
						
						In PHP what is the correct way to add 1 to the $count variable?
						
						
						* A. ```$count=+1;```
						* B. ```++count;```
						* C. ```$count++;```
						* D. ```count++;```
				

						</textarea>
					</section>
					
					<section data-markdown data-transition="slide" data-background="#20533c" data-background-transition="zoom">
						<textarea data-template>
						## Answer
						
						Answer: **C.** ```$count++```

						</textarea>
					</section>
				</section>
				
				
				<section>
					<section data-markdown data-transition="slide" data-background="#20538c" data-background-transition="zoom">
						<textarea data-template>
						## Revision Question
						
						What would be in each line of the following PHP?
						
						```
						$foo = "0";                  // $foo is ??
						$foo += 2;                   // $foo is ??
						$foo = $foo + 1.3;           // $foo is ??
						$foo = 5 + "10 little bits"; // $foo is ??
						$foo = 5 + "20 little bits"; // $foo is ??
						```
				

						</textarea>
					</section>
					
					<section data-markdown data-transition="slide" data-background="#20538c" data-background-transition="zoom">
						<textarea data-template>
						## Answer
						
						```
						<?php
						$foo = "0";                  // $foo is a string("0")
						$foo += 2;                   // $foo is an integer(2)
						$foo = $foo + 1.3;           // $foo is now a float(3.3)
						$foo = 5 + "10 little bits"; // $foo is integer(15)
						$foo = 5 + "20 little bits"; // $foo is integer(25)
						?>
						```
						
						Try out on [PHP Sandbox](https://phpsandbox.html5css.ru/)

						</textarea>
					</section>
				</section>
				
				
				
				
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## PHP Databases 
						
						* PHP supports a wide range of **databases**
						  - MySQL, SQLITE, NoSQL, ...
						* PHP **compatable** with almost all servers
						
Note:
Web applications including PHP often require to store and retrieve data to perform their job and produce dynamic web content. 
There are numerous examples of  such applications, ticket reservation, hotel booking, online stores, subscription services, etc. 

Storing and retrieving data can be done using the file system. This might be an option for small amount data but 
when dealing with larger and more complicated data a lot of development effort is required, which is error prone and not efficient. 
In these scenarios databases are the rational choice. 
PHP support a wide range of database technologies including MySQL, PostgreSQL, Windows SQL server, SQLITE, NoSQL, etc. 
						
					</textarea>
				</section>
				
				<section data-markdown style="text-align: center;">
					<textarea data-template>
						## Focus on SQLite
					</textarea>
				</section>
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## What is **SQLite**?

						* **Embedded** SQL Database Engine (**PHP**)
						* **Serverless** - accesses disk directly
						* Single file
						* Cross platform / architecture
						* Small size/footprint
						* Reliable
Note:
As the name implies SQLite is a lightweight database management system.

SQLite is an embedded SQL database engine. Unlike most other SQL databases, SQLite does not have a separate server process. 

SQLite reads and writes directly to ordinary disk files. 

A complete SQL database with multiple tables, indices, triggers, and views, is contained in a single disk file. 

The database file format is cross-platform - you can freely copy a database between 32-bit and 64-bit systems or between big-endian and little-endian architectures. 

SQLite is a compact library. With all features enabled, the library size can be less than 1MB.

It is carefully tested before each release and is highly reliable.

					</textarea>
				</section>
				
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Why SQLite?
						
						* Zero configuration
						* **Portable**
						* Public domain (open source)
						* Adobe, Apple, Google, McAfee, Firefox, Skype
Note:
SQLite is an in-process library that implements a self-contained, serverless, zero-configuration, SQL database engine. 

SQLite code is in the public domain and is free for both private and commercial use. 

It has been adopted by many major brands including Adobe, Apple, Google, Firefox and skype in their applications. 

In fact it is the most widely used database platform due its use in devices and websites. 

All These features in addition to the features mentioned in the previous slide, make SQLite a popular choice.

					</textarea>
				</section>

				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Where can SQLite be used?
						
						* Replacement for a custom file format
						* Temporary storage 
						* Alternative to enterpise DB
						* Local node storage
						* **Communication between apps**
						* Embedded devices
Note:
SQLite is often used as the on-disk file format for desktop applications.  
Updates happen automatically as application content is revised. 
There are many benefits to this approach, including improved performance, reduced cost and complexity, and improved reliability.

Can be used as an **in-memory** database to store and manipulate temporary data.

SQLite can be used as the database engine in enterprises with low to medium size database..

Can replace ordinary disk files to store information

SQLite can be used as a container for transferring content from one system to another since the whole database is a single compact file in a well-defined cross-platform format.

Because an SQLite database requires no administration, it works well in devices. 
SQLite is a good fit for use in phones, televisions, game consoles, kitchen appliances, etc.

					</textarea>
				</section>


				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Is SQLite Supported? 
						
						```
						<?php
						if (extension_loaded('sqlite3')) 
						{
							echo("**extension sqlite3 available**");
						}
						else 
						{
							echo 'sqlite3 not loaded';
						}
						?>
						```
						
						You can see the names of various extensions by using ```phpinfo()```
						
						[Try on CodePad](http://codepad.org/DRPqPriD)

Note:
SQLite has interface for different languages including PHP.
SQLite3 has been included by default a part of the PHP 5.3.0 
You can see the name of various extensions in your PHP environment including SQLite by using phpinfo and the *extesnsion_loaded* function

					</textarea>
				</section>
				
				<!--
				<section>
				<h2>Example</h2>

				<iframe data-src="http://codepad.org/DRPqPriD"  width="80%" height="500px" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:3px solid #666; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>
				
				<div style="position: absolute; width: 40%; right: 0; box-shadow: 0 1px 4px rgba(0,0,0,0.5), 0 5px 25px rgba(0,0,0,0.2); background-color: rgba(0, 0, 0, 0.9); color: #fff; padding: 20px; font-size: 20px; text-align: left;">
							<h2 style="color:white">
								Example</h2>
							<p>phpinfo() output</p>
							
				</div>
						
				</section>
				-->
				
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Example 
						
						```
						<?php
						$ver = SQLite3::version();

						echo $ver['versionString'] . "\n";
						echo $ver['versionNumber'] . "\n";

						var_dump($ver);
						?>
						```
						
						Output
						```
						3.20.1
						3020001
						array(2) {
							["versionString"]=>
							string(6) "3.20.1"
							["versionNumber"]=>
							int(3020001) }
						```
Note:
This example shows you how to display SQLite version information in PHP
					</textarea>
				</section>
				
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Example 
						
						```
						<?php
						$db = new SQLite3('/test.db', SQLITE3_OPEN_CREATE );
						
						$version = $db->querySingle('SELECT SQLITE_VERSION()');

						echo $version . "\n";
						?>
						```
						
						Output:
						```
						$ php version.php
						3.20.1
						```
Note:
You will study databases in a dedicated module next semester.

Here we only see some introductory use of databases in the context of PHP.

In general a relation database is a set of tables. 
Each table usually contains information about a group of similar objects where each row contains information of an individual object. 

For example, each row of a Book table can contain information for each individual book in a library, 
or each row of a customer table contains an individual customer’s data.

SQL is a language for querying relational databases (i.e. querying information contained in the tables of the database).

The example shows how to create a database in the first instance. 
The database name is test.db and it will be created or just opened if it already exists.  

The second line runs a simple query against the database to check the version of the database.

					</textarea>
				</section>
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Database Type

						In memory database 
						```
						$db = new SQLite3(':memory:');
						```
						
						Temporary database (no file name)
						```
						$db = new SQLite3('');
						```
   
						Standard file database 
						```
						$db = new SQLite3('mydb/mydb.db');
						```
   
						Shared cache database 
						```
						define( 'SQLITE3_OPEN_SHAREDCACHE' , 0x00020000 );
						$db = new SQLite3( 'sqlite.db3' , 
						SQLITE3_OPEN_READWRITE  | SQLITE3_OPEN_CREATE |     SQLITE3_OPEN_SHAREDCACHE );
						```
Note:
Using new SQLite you can create different types of database.

If the filename is given as ':memory:', SQLite3 will create an in-memory database in RAM that lasts only for the duration of the session. 

If no file name is given then a new temporary file is created to hold the database. Temporary databases are automatically deleted when the 
conection that created them closes.

The database is opened shared cache enabled. If shared-cache mode is enabled multiple connections to the same database, 
all the connections share a single data and schema cache. 

This intended for embedded system to reduce the memory usage and is not set by default.

					</textarea>
				</section>
				
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Database Queries

						Supports standard database queries
						* CREATE TABLE
						* INSERT INTO 
						* SELECT * FROM
						* ..
						
						Further Reading [Link](http://zetcode.com/php/sqlite3/)
					</textarea>
				</section>
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Example Database Queries

						* Create table if one doesn't exist
						* Insert id/name into the table 
						* Select and display the id/names from the table
						
						```
						$db->exec("CREATE TABLE IF NOT EXISTS friends(id INTEGER PRIMARY KEY, name TEXT)");

						$db->exec("INSERT INTO friends(name) VALUES ('Tom')");
						$db->exec("INSERT INTO friends(name) VALUES ('Rebecca')");
						$db->exec("INSERT INTO friends(name) VALUES ('Jim')");

						$res = $db->query('SELECT * FROM friends');

						while ($row = $res->fetchArray()) {
							echo "{$row[0]} {$row[1]}\n";
						}
						```
Note:
SQL queries are used to create and populate database tables and retrieving data.

To run SQLite queries you can use the exec function and pass a query statement (SQL) as its parameter.

In this example first a Create query creates a table called friends with two column id and name. 

The next three Insert statements add three rows to the table. Only value for the name column is provided the Id value is generated automatically. 

The Select statement will retrieve all the rows from the friends table an put in $res variable.
						
					</textarea>
				</section>
				
				
				<!--
				<section>
				<iframe data-src="https://www.jdoodle.com/execute-sql-online/"  width="80%" height="650px" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:3px solid #666; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>
				
				<div style="position: absolute; width: 40%; right: 0; box-shadow: 0 1px 4px rgba(0,0,0,0.5), 0 5px 25px rgba(0,0,0,0.2); background-color: rgba(0, 0, 0, 0.9); color: #fff; padding: 20px; font-size: 20px; text-align: left;">
							<h2 style="color:white">
								Online PHP Sandbox/SQLite</h2>
							<p>Easily test out your database commands</p>
							<p>Examples/snippets</p>

						</div>
				</section>	
				-->
				
				<section>
				<iframe data-src="https://www.jdoodle.com/embed/v0/1v79"  width="80%" height="570px" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:3px solid #666; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>
				
				<div style="position: absolute; width: 40%; right: 0; box-shadow: 0 1px 4px rgba(0,0,0,0.5), 0 5px 25px rgba(0,0,0,0.2); background-color: rgba(0, 0, 0, 0.9); color: #fff; padding: 20px; font-size: 20px; text-align: left;">
							<h2 style="color:white">
								Online PHP Sandbox/SQLite</h2>
							<p>Easily test out your database commands</p>
							<p>Examples/snippets</p>

						</div>
				</section>	
				
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
					
					## Minimal Example
					
					```
					echo 'Creating SQLite DB<br>';
					$db = new SQLite3(':memory:'); // In memory database 
					```
					
					```
					$version = $db->querySingle('SELECT SQLITE_VERSION()');
					echo $version . "<br>";

					$v = $db->exec("CREATE TABLE IF NOT EXISTS tbl(id INTEGER, name TEXT)");
					echo "v: " . $v . "<br>";

					$db->exec("INSERT INTO tbl(name) VALUES ('Tom')");
					$db->exec("INSERT INTO tbl(name) VALUES ('Rebecca')");
					```
					
					```
					$res = $db->query('SELECT * FROM tbl');
					while ($row = $res->fetchArray()) {
						echo "Reading:" . "{$row[0]} {$row[1]} <br>";
					}
					```
					
					[Test in PHP Sandbox](https://phpsandbox.html5css.ru/)
					</textarea>
				</section>
				
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Command Prompt

						```
						:\>sqlite3
						SQLite version 3.30.0 
						Enter ".help" for usage hints
						sqlite>CREATE table tb1 (one varchar(10), two smallint);
						sqlite>INSERT into tb1 values('hello', 10);
						sqlite>INSERT into tb1 values('goodbye', 40);
						sqlite>SELECT * from tb1;
						hello|10
						goodbye|40
						sqlite>
						```
Note:
SQLite has also command prompt interface. 

You can use the command prompt interface to access the database directly in opposed to interacting through a programming language interface like PHP.

You can use the command prompt to create and/or connect to databases, create and populated tables, to query databases directly. 
						
					</textarea>
				</section>
				
				
				
			
				<section data-markdown style="text-align: left;">
					<textarea data-template>
						## Summary

						* Understand PHP and Databases
						* **Save/load** information from Database
						* Database System
						  - **SQLite**
						
					</textarea>
				</section>


				<section data-markdown style="text-align: left;">
					<textarea data-template>
					## To do this week ...
					
					* Read over the lectures 
					* **Review** the revision questions 
					* Work through tutorial practicals 
					* **Experiment** (get into good habits) 
					* Read SQLite 
					[link](https://www.tutorialspoint.com/sqlite/index.htm)
					* MySQL Tutorial
					[link](http://www.mysqltutorial.org/)
					* Beginning PHP and MySQL Book
					[link](http://minitorn.tlu.ee/~jaagup/kool/java/kursused/14/webpr/beginning_php_and_mysql_from_novice_to_professional_4th_edition.pdf)
						
						
					</textarea>
				</section>
				

			</div>

		</div>

		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				center: true,
				hash: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true },
					{ src: 'plugin/search/search.js', async: true },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>



<div class="hidden-mobile">
    <div style="display: block; position: absolute; bottom: 5px; left: 5px; margin-left: 0px; z-index: 20;">
        <a href="https://f28wp.github.io" class="twitter-follow-button" data-show-count="false"><img src="images/webhome.png" width="8%"></a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    </div>
</div>

<div class="hidden-mobile">
    <div style="display: block; position: absolute; bottom: 3px; left: 50px; margin-left: 0px; z-index: 20; text-align: left;">
		<a href="?print-pdf" onclick="window.open(this.href, 'print window', 'width=1000,height=550').print(); return false"><img src="images/webprint.png" width="7.5%"></a>
    </div>
</div>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-148326645-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-148326645-1');
</script>

	</body>
</html>
